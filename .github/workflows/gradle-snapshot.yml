name: Release Snapshot

on:
  workflow_run:
    workflows: [ "Java Build With Gradle" ]
    types:
      - completed

jobs:
  snapshot:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - uses: znsio/specmatic-github-workflows/action-gradle-post-build@main
        with:
          gradle-extra-args: >
            publishAllPublicationsToMavenCentralRepository 
            -PmavenCentralUsername=${{ secrets.SPECMATIC_MAVEN_CENTRAL_USERNAME }} 
            -PmavenCentralPassword=${{ secrets.SPECMATIC_MAVEN_CENTRAL_PASSWORD }}
            -PsigningInMemoryKeyId=${{ secrets.SPECMATIC_GPG_PRIVATE_KEY_ID }}
            -PsigningInMemoryKeyPassword=${{ secrets.SPECMATIC_GPG_PRIVATE_KEY_PASSPHRASE }}
            -PsigningInMemoryKey=${{ secrets.SPECMATIC_GPG_PRIVATE_KEY }}
